(function(){"use strict";const i={easy:50,medium:40,hard:30},E=50,h=[[1,2,3,4,5,6,7,8,9],[4,5,6,7,8,9,1,2,3],[7,8,9,1,2,3,4,5,6],[2,3,1,5,6,4,8,9,7],[5,6,4,8,9,7,2,3,1],[8,9,7,2,3,1,5,6,4],[3,1,2,6,4,5,9,7,8],[6,4,5,9,7,8,3,1,2],[9,7,8,3,1,2,6,4,5]],_=t=>t.map(n=>n.map(o=>o?{type:"clue",value:o}:{notes:Array(9).fill(null),type:"empty",value:o})),r=t=>Math.floor(t/3),I=t=>t%3,f=t=>t.map(n=>[...n]),m=t=>t.map((n,o)=>n.map((c,s)=>{const e=r(s),l=r(o),a=I(s),u=I(o),k=e+l*3,b=a+u*3;return t[k][b]})),d=t=>t.map((n,o)=>n.map((c,s)=>t[s][o])),B=(t,n,o)=>t[n].some(c=>c===o),C=(t,n,o)=>d(t)[n].some(s=>s===o),O=(t,n,o,c)=>{const s=m(t),e=r(o),l=r(n),a=e+l*3;return s[a].some(u=>u===c)},p=(t,n,o,c)=>!B(t,n,c)&&!C(t,o,c)&&!O(t,n,o,c),L=t=>{let n=0;const o=c=>{for(let s=0;s<9;s++)for(let e=0;e<9;e++)if(!c[s][e]){for(let l=1;l<=9;l++)if(p(c,s,e,l)){if(c[s][e]=l,o(c))return!0;c[s][e]=null}return!1}return n++,n>1};return o(t),n===1},R=(t,n)=>{const o=f(t),c=81-n;for(let s=0;s<c;s++){const e=Math.floor(Math.random()*9),l=Math.floor(Math.random()*9);if(!o[e][l]){s-=1;continue}const a=o[e][l];o[e][l]=null,L(f(o))||(o[e][l]=a,s-=1)}return o},Z=(t,n)=>t.findIndex((o,c)=>o===t[n]&&n!==c),M=(t,n,o)=>{[n[o],t[o]]=[t[o],n[o]]},S=(t,n,o,c=!1)=>{const s=c?o:Z(t,o);s!==-1&&(M(t,n,s),S(t,n,s))},x=t=>{const n=t+1,o=I(n),s=r(t)*3;return o+s},D=(t,n)=>{let o=f(t);for(let c=0;c<n;c++){const s=!!Math.floor(Math.random()*2);s&&(o=d(o));const e=Math.floor(Math.random()*9),l=Math.floor(Math.random()*9),a=o[e],u=o[x(e)];S(a,u,l,!0),s&&(o=d(o))}return o};self.addEventListener("message",({data:{difficulty:t}})=>{const n=D(h,E),o=R(n,i[t]),s={board:_(o),matrix:n};self.postMessage(s)})})();
